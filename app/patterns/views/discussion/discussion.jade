h1
  = discussion.title

if url.page === 1
  p
    != discussion.description
  
include ../partials/pagination

if announcements
  section.announcements
    h2 Announcements
    each announcement in announcements
      article.announcement(data-announcement-id="#{announcement.id}")
        h3
          a(href="announcement/#{announcement.url}/id/#{announcement.id}") #{announcement.titleHtml}
          
section.topics
  h2 Topics
  nav.discussion
    ul
      li.new-topic
        a(href="topic/action/start/id/#{discussion.id}") Start a new topic
      if session.moderateDiscussions
        li.new-announcement
          a(href="announcement/action/write/id/#{discussion.id}") Make an announcement
      li.subscribe
        a(href="#{route.pathname}/action/subscribe" title="Receive an e-mail notification when new topics are added to this discussion.") Subscribe to this discussion
  if topics
    each topic in topics
      article.topic(data-topic-id="#{topic.id}")
        h3
          a(href="topic/#{topic.url}/id/#{topic.id}")
            != topic.titleHtml
        p.details
          | Posted by 
          a(href="user/#{topic.topicStarterUrl}" rel="author" title="View #{topic.topicStarter}'s profile.") #{topic.topicStarter}
          |  on 
          time #{topic.postDate}
        p.stats
          span.replies #{topic.replies} 
          | replies with 
          span.views #{topic.views} 
          | views
  else
    p This discussion has no topics. <a href="topic/action/write/id/#{discussion.id}">Why not start one?</a>

include ../partials/pagination
