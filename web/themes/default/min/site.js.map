{"version":3,"sources":["immediate.js","global.js","init.js","post.js","topic.js","user.js"],"names":["window","CF","immediate","init","document","querySelector","classList","add","global","methods","accountNavTimer","menuIcon","body","bodyOffset","header","accountNav","addEventListener","getBoundingClientRect","top","Math","abs","height","contains","remove","createElement","setAttribute","appendChild","createTextNode","insertBefore","menu","trigger","position","clientWidth","setTimeout","clearTimeout","e","preventDefault","collapseQuotes","quotes","querySelectorAll","bindButton","quote","expandButton","innerHTML","toggle","i","length","args","source","menuShadow","cloneNode","className","keepClass","removeChild","parentNode","getElementsByTagName","controller","getAttribute","action","view","onreadystatechange","readyState","post","topic","actions","handler","mask","form","postContent","forEach","item","zoomWrapper","imageWrapper","parent","src","start","reply","getElementById","postContentText","value","startPrivate","startAnnouncement","announcement","user"],"mappings":"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","file":"site.js","sourcesContent":["window.CF = {}\n\nCF.immediate = ( function () {\n  'use strict'\n\n  var methods = {\n    init: function () {\n      document.querySelector('html').classList.add('js')\n    }\n  }\n\n  //  Public methods\n  return {\n    init: methods.init\n  }\n\n})(CF)\n\nCF.immediate.init()\n","CF.global = ( function () {\n  'use strict'\n  var methods = {\n\n    init: function () {\n      var body = document.querySelector('body'),\n          bodyOffset = 0,\n          header = document.querySelector('body > header'),\n          accountNav = header.querySelector('nav ul.account'),\n          accountNavTimer,\n          menuIcon\n\n      window.addEventListener('scroll', function () {\n        if ( bodyOffset > body.getBoundingClientRect().top && Math.abs(body.getBoundingClientRect().top) > header.getBoundingClientRect().height && !body.classList.contains('floating-header') ) {\n          body.classList.add('floating-header')\n        // The second half of the statement deals with Safari's bounceback when you scroll past the top of the page\n        } else if ( body.getBoundingClientRect().top >= bodyOffset || Math.abs(body.getBoundingClientRect().top) <= header.getBoundingClientRect().height ) {\n          body.classList.remove('floating-header')\n        }\n\n        bodyOffset = body.getBoundingClientRect().top\n      })\n\n      // Create the main menu icon\n      menuIcon = document.createElement('div')\n\n      menuIcon.setAttribute('id', 'main-menu-icon')\n      menuIcon.appendChild(document.createTextNode('Menu'))\n      header.insertBefore(menuIcon, header.querySelector('a.home'))\n\n      methods.menu({\n        menu: 'header nav',\n        trigger: '#main-menu-icon',\n        position: 'left'\n      })\n\n      if ( document.body.clientWidth >= 600 ) {\n        accountNav.addEventListener('mouseleave', function () {\n          accountNavTimer = setTimeout( function () {\n            accountNav.classList.remove('active')\n          }, 500)\n        }, false)\n\n        accountNav.addEventListener('mouseover', function () {\n          if ( accountNavTimer ) {\n            clearTimeout(accountNavTimer)\n          }\n        })\n\n        if ( header.classList.contains('authenticated') ) {\n          header.querySelector('a.account').addEventListener('click', function (e) {\n            if ( document.body.clientWidth >= 600 ) { // Just in case they resized the window\n              e.preventDefault()\n            }\n            if ( accountNav.classList.contains('active') ) {\n              accountNav.classList.remove('active')\n            } else {\n              accountNav.classList.add('active')\n            }\n          })\n\n          window.addEventListener('scroll', function () {\n            if ( accountNav.classList.contains('active') ) {\n              accountNav.classList.remove('active')\n            }\n          })\n        }\n      }\n    },\n\n    collapseQuotes: function () {\n      var quotes = document.body.querySelectorAll('section.content > blockquote'),\n          bindButton = function (quote) {\n            var expandButton = document.createElement('a')\n\n            expandButton.setAttribute('href', '#')\n            expandButton.classList.add('expand')\n            expandButton.innerHTML = 'Expand'\n            expandButton.addEventListener('click', function (e) {\n              e.preventDefault()\n              quote.classList.toggle('expanded')\n              if ( expandButton.innerHTML === 'Expand' ) {\n                expandButton.innerHTML = 'Collapse'\n              } else {\n                expandButton.innerHTML = 'Expand'\n              }\n            })\n            quote.classList.add('nested')\n            quote.appendChild(expandButton)\n          }\n\n      for ( var i = 0; i < quotes.length; i++ ) {\n        if ( quotes[i].querySelector('blockquote') ) {\n          bindButton(quotes[i])\n        }\n      }\n    },\n\n    menu: function (args) {\n      var body = document.querySelector('body'),\n          menu,\n          trigger = document.querySelector(args.trigger)\n\n      trigger.addEventListener('click', function () {\n        var source = document.querySelector(args.menu),\n            menuShadow = document.createElement('div')\n\n        menu = source.cloneNode(true)\n        body.appendChild(menu)\n        menuShadow.className = 'menu-shadow'\n        body.appendChild(menuShadow)\n\n        if ( args.keepClass === false ) {\n          menu.className = 'slide-menu ' + args.position\n        } else {\n          menu.className += ' slide-menu ' + args.position\n        }\n\n        if ( body.classList.contains('menu-open') ) {\n          body.classList.remove('menu-open')\n          menu.classList.remove('open')\n          body.classList.add('menu-closing')\n          setTimeout( function () {\n            body.classList.remove('menu-closing')\n          }, 200)\n        } else {\n          body.classList.add('menu-opening')\n          setTimeout( function () {\n            body.classList.remove('menu-opening')\n            body.classList.add('menu-open')\n            menu.classList.add('open')\n          }, 200)\n        }\n\n        menuShadow.addEventListener('click', function () {\n          body.classList.remove('menu-open')\n          menu.classList.remove('open')\n          body.classList.add('menu-closing')\n          setTimeout( function () {\n            body.classList.remove('menu-closing')\n            body.removeChild(menuShadow)\n            if ( menu.parentNode !== null ) {\n              body.removeChild(menu)\n            }\n          }, 200)\n        }, false)\n      }, false)\n    },\n\n    // ajaxFormBinding: function(options) {\n    //   var form = document.querySelector(options.formSelector),\n    //       format = options.format || 'json',\n    //       type = options.type || 'direct'\n\n    //   form.addEventListener('submit', function (e) {\n    //     var request = new XMLHttpRequest(),\n    //         formData = new FormData(form),\n    //         data\n\n    //     e.preventDefault()\n\n    //     request.open('POST', form.action + '/format/' + format + '/type/' + type, true)\n    //     request.setRequestHeader('X-Requested-With', 'XMLHttpRequest')\n    //     // request.setRequestHeader('Content-Type', 'application/json')\n    //     request.send(formData)\n\n    //     request.onreadystatechange = function () {\n    //       console.log('readyState: ' + request.readyState)\n    //       console.log('status: ' + request.status)\n    //     }\n\n    //     request.onload = function () {\n    //       if ( request.status >= 200 && request.status < 400 ) {\n    //         data = JSON.parse(request.responseText)\n    //         console.log(data)\n    //       } else {\n    //         // We reached our target server, but it returned an error\n    //       }\n    //     }\n\n    //     request.onerror = function () {\n    //       // There was a connection error of some sort\n    //     }\n    //   })\n\n    //   // Some browsers don't include the submit button's value when form.submit() is\n    //   // called. This function creates a click listener that duplicates a form's submit\n    //   // button as a hidden field so its name/value can be included in AJAX POSTs,\n    //   // allowing different processing based on different submit buttons.\n    //   form.addEventListener('click', function (e) {\n    //     var input = document.createElement('input'),\n    //         previousActions = form.querySelectorAll('input[type=\"hidden\"].submit-surrogate')\n\n    //     for ( var i = 0; i < previousActions.length; i++ ) {\n    //       form.removeChild(previousActions[i])\n    //     }\n\n    //     if ( e.target.type && e.target.type.toLowerCase() === 'submit' ) {\n    //       input.name = e.target.name\n    //       input.type = 'hidden'\n    //       input.value = e.target.value\n    //       input.className = 'submit-surrogate'\n\n    //       form.appendChild(input)\n    //     }\n    //   })\n    // }\n  }\n\n  //  Public methods\n  return {\n    // ajaxFormBinding: methods.ajaxFormBinding,\n    collapseQuotes: methods.collapseQuotes,\n    init: methods.init,\n    menu: methods.menu\n  }\n\n}(CF))\n","CF.init = function () {\n  'use strict'\n\n  var body = document.getElementsByTagName('body')[0],\n      controller = body.getAttribute('data-controller'),\n      action = body.getAttribute('data-action'),\n      view = body.getAttribute('data-view')\n\n  CF.global.init()\n\n  if ( CF[controller] ) {\n    CF[controller].init()\n\n    if ( CF[controller][action] && typeof CF[controller][action] === 'function' ) {\n      CF[controller][action]()\n\n      if ( CF[controller][action][view] ) {\n        CF[controller][action][view]()\n      }\n    }\n  }\n}\n\ndocument.onreadystatechange = function () {\n  'use strict'\n\n  if ( document.readyState === 'interactive' ) {\n    CF.init()\n  }\n}\n","CF.post = ( function () {\n  'use strict'\n\n  var methods = {\n\n\t\tinit: function () {\n      CF.global.collapseQuotes()\n\t\t}\n\n  }\n\n\t//\tPublic methods\n\treturn {\n\t\tinit: methods.init\n\t}\n\n})(CF)","CF.topic = ( function () {\n  'use strict'\n\n  var actions, methods\n\n\tactions = {\n\n    handler: function () {\n      var form = document.querySelector('#quick-reply-form'),\n          mask\n\n      if ( form && !form.parentNode.classList.contains('quote') ) {\n        methods.postContent()\n      }\n\n      if ( document.body.clientWidth >= 720 ) {\n        mask = document.createElement('div')\n        mask.setAttribute('id', 'mask')\n        document.body.appendChild(mask)\n\n        document.querySelectorAll('section.posts article.post section.content.post p > img, section.posts article.post section.content.post > img').forEach( function (item) {\n          var zoomWrapper = document.createElement('span'),\n              imageWrapper = document.createElement('span'),\n              parent = item.parentNode,\n              src = item.getAttribute('src')\n          \n          zoomWrapper.classList.add('zoom')\n          imageWrapper.classList.add('zoom-image')\n          zoomWrapper.appendChild(imageWrapper)\n          parent.appendChild(zoomWrapper)\n          parent.insertBefore(zoomWrapper, item)\n          imageWrapper.appendChild(item)\n\n          imageWrapper.addEventListener('click', function () {\n            mask.innerHTML = '<div id=\"mask-close\"></div><img src=\"' + src + '\"><a class=\"open-tab\" href=\"' + src + '\" target=\"_blank\">' + src + '</a>'\n            document.querySelector('html').classList.add('mask-enabled')\n            mask.classList.add('enabled')\n\n            mask.querySelector('#mask-close').addEventListener('click', function () {\n              mask.classList.add('closing')\n              document.querySelector('html').classList.remove('mask-enabled')\n\n              setTimeout( function () {\n                mask.classList.remove('closing', 'enabled')\n                mask.innerHTML = ''\n              }, 200)\n            })\n          })\n        })\n      }\n    },\n\n    start: function () {\n      // CF.global.ajaxFormBinding({\n      //   formSelector: '#topic-write-form'\n      // })\n      methods.postContent()\n    },\n\n    reply: function () {\n      // CF.global.ajaxFormBinding({\n      //   formSelector: '#topic-reply-form'\n      // })\n      var form = document.querySelector('#topic-reply-form')\n\n      if ( form && !form.parentNode.classList.contains('quote') ) {\n        methods.postContent()\n      }\n    }\n\n\t}\n\n  methods = {\n\n\t\tinit: function () {\n      CF.global.collapseQuotes()\n\t\t},\n\n    postContent: function () {\n      var postContent = document.getElementById('post-content'),\n          postContentText = postContent ? postContent.value : ''\n\n      if ( postContent ) {\n        postContent.addEventListener('focus', function () {\n          if ( postContent.value === postContentText ) {\n            postContent.value = ''\n          }\n        })\n        postContent.addEventListener('blur', function () {\n          if ( postContent.value === '' ) {\n            postContent.value = postContentText\n          }\n        })\n      }\n    }\n\n  }\n\n\t//\tPublic methods\n\treturn {\n\t\tinit: methods.init,\n    handler: actions.handler,\n    start: actions.start,\n    startPrivate: actions.start,\n    startAnnouncement: actions.start,\n    reply: actions.reply\n\t}\n\n})(CF)\n\n\n// For now, the announcement library is the same as the topic library\nCF.announcement = CF.topic\n","CF.user = ( function () {\n  'use strict'\n\n  var methods = {\n\n      init: function () {\n        CF.global.collapseQuotes()\n      }\n\n    }\n\n  //  Public methods\n  return {\n    init: methods.init\n  }\n\n})(CF)\n"]}